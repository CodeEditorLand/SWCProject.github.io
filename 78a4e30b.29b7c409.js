(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{186:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return o})),n.d(t,"default",(function(){return p}));var a=n(3),r=n(7),s=(n(0),n(333)),c={title:"Changelog: swc v1.1.4",author:"DongYoon Kang",authorURL:"http://github.com/kdy1",authorFBID:0x5af8dbecdbce},l={permalink:"/blog/2019/12/09/swc-1.1.4",source:"@site/blog/2019-12-09-swc-1.1.4.md",description:"loose mode",date:"2019-12-09T00:00:00.000Z",tags:[],title:"Changelog: swc v1.1.4",readingTime:3.475,truncated:!1,prevItem:{title:"Changelog: swc v1.1.5",permalink:"/blog/2019/12/11/swc-1.1.5"},nextItem:{title:"Changelog: swc v1.1.3",permalink:"/blog/2019/12/04/swc-1.1.3"}},o=[{value:"loose mode",id:"loose-mode",children:[]},{value:"Lots of bug fix (#489)",id:"lots-of-bug-fix-489",children:[{value:"resolver pass",id:"resolver-pass",children:[]},{value:"hygiene pass",id:"hygiene-pass",children:[]},{value:"fixer pass",id:"fixer-pass",children:[]},{value:"classes pass",id:"classes-pass",children:[]},{value:"computed_properties pass",id:"computed_properties-pass",children:[]},{value:"destructuring pass",id:"destructuring-pass",children:[]},{value:"for_of pass",id:"for_of-pass",children:[]},{value:"spread pass",id:"spread-pass",children:[]},{value:"template_literal pass",id:"template_literal-pass",children:[]},{value:"class_properties pass",id:"class_properties-pass",children:[]},{value:"object rest spread pass",id:"object-rest-spread-pass",children:[]},{value:"async_to_generator pass",id:"async_to_generator-pass",children:[]}]}],b={toc:o};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"loose-mode"},"loose mode"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," now has a loose mode, just like babel 2015 transform.\nSee ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/configuring-swc#jscloose"}),"doc")," for more detail."),Object(s.b)("h2",{id:"lots-of-bug-fix-489"},"Lots of bug fix (",Object(s.b)("a",Object(a.a)({parentName:"h2"},{href:"https://github.com/swc-project/swc/pull/489"}),"#489"),")"),Object(s.b)("p",null,"I copied almost all tests from babel, and fixed lots of bugs."),Object(s.b)("h3",{id:"resolver-pass"},"resolver pass"),Object(s.b)("p",null,"Resolver pass, along with hygiene and fixer, is core of the swc."),Object(s.b)("h4",{id:"handle-object-literals-correctly"},"Handle object literals correctly"),Object(s.b)("p",null,"Previously, key of an object literal may interfere with outer identifiers. It means,"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'let a = {\n  b: "c"\n};\nuse(b);\n')),Object(s.b)("p",null,"Second usage of ",Object(s.b)("inlineCode",{parentName:"p"},"b")," could be interfered by ",Object(s.b)("inlineCode",{parentName:"p"},"b")," in ",Object(s.b)("inlineCode",{parentName:"p"},"a"),". ",Object(s.b)("inlineCode",{parentName:"p"},"swc")," now hanldes it correctly."),Object(s.b)("h3",{id:"hygiene-pass"},"hygiene pass"),Object(s.b)("h4",{id:"renaming-of-computed-property-name"},"Renaming of computed property name"),Object(s.b)("p",null,"Previously,"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'class A {\n  [key#1]: "foo";\n  [key#2]: "bar";\n}\n')),Object(s.b)("p",null,"(where #n is hygiene number)"),Object(s.b)("p",null,"was compiled to"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'class A {\n  [key]: "foo";\n  [key]: "bar";\n}\n')),Object(s.b)("p",null,"which results in a bug. It is now compiled as"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'class A {\n  [key]: "foo";\n  [key1]: "bar";\n}\n')),Object(s.b)("h3",{id:"fixer-pass"},"fixer pass"),Object(s.b)("h4",{id:"export-default-expression"},"export default expression"),Object(s.b)("p",null,"The arrow expression lke"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"export default arrow => foo;\n")),Object(s.b)("p",null,"and sequence expression like"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"export default a, b, c;\n")),Object(s.b)("p",null,"is now wrapped with a parenthesis."),Object(s.b)("h4",{id:"sequence-expression-in-an-arrow-expression"},"sequence expression in an arrow expression"),Object(s.b)("p",null,"Previously"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"() => (a, b, c);\n")),Object(s.b)("p",null,"was compiled as"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"() => a, b, c;\n")),Object(s.b)("p",null,"which is wrong."),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," now compiles it as"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"() => (a, b, c);\n")),Object(s.b)("h3",{id:"classes-pass"},"classes pass"),Object(s.b)("h4",{id:"handle-super-accesses-correctly"},"Handle super accesses correctly"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," now handles all valid super accesses. It includes something strange like"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"class Parent {}\nclass Outer extends Parent {\n  constructor() {\n    class Inner {\n      [super()] = 1;\n    }\n  }\n}\n")),Object(s.b)("h3",{id:"computed_properties-pass"},"computed_properties pass"),Object(s.b)("h4",{id:"better-codegen"},"Better codegen"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"let foo = { a, [b]: c };\n")),Object(s.b)("p",null,"is now compiled as"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"let((_ref = { a }), defineProperty(_ref, b, c), _ref);\n")),Object(s.b)("p",null,"instead of"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"let((_ref = {}), defineProperty(_ref, a, a), defineProperty(_ref, b, c), _ref);\n")),Object(s.b)("h3",{id:"destructuring-pass"},"destructuring pass"),Object(s.b)("h4",{id:"for-of-for-in-loop-support"},"for-of, for-in loop support"),Object(s.b)("p",null,"From now, for-of loop and for-in are supported."),Object(s.b)("h4",{id:"loose-mode-is-here"},"loose mode is here"),Object(s.b)("p",null,"If you want smaller output, you can turn on loose mode."),Object(s.b)("h3",{id:"for_of-pass"},"for_of pass"),Object(s.b)("h4",{id:"assume_array-mode-is-here"},"assume_array mode is here"),Object(s.b)("p",null,"If you want smaller output, you can turn on assume_array by enabling loose mode."),Object(s.b)("h4",{id:"labelled-for-loop-is-handled-correctly"},"labelled for loop is handled correctly"),Object(s.b)("p",null,"Previously, label was stripped out without any error message, and it resulted in a runtime error. ",Object(s.b)("inlineCode",{parentName:"p"},"swc")," now handles labaelled loops correctly."),Object(s.b)("h3",{id:"spread-pass"},"spread pass"),Object(s.b)("h4",{id:"loose-mode-is-here-1"},"loose mode is here"),Object(s.b)("p",null,"If you don't want ",Object(s.b)("inlineCode",{parentName:"p"},"_toConsumableArray")," in output, you can turn on loose mode."),Object(s.b)("h3",{id:"template_literal-pass"},"template_literal pass"),Object(s.b)("h4",{id:"performance"},"Performance"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"template_literal")," pass become much more performant by removing redundant ",Object(s.b)("inlineCode",{parentName:"p"},".clone()"),"s."),Object(s.b)("h4",{id:"literal"},"Literal"),Object(s.b)("p",null,"The pass try it's best to reduce template literals into constant."),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'let a = `${"foo"}bar`;\n')),Object(s.b)("p",null,"is compiled as"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'let a = "foobar";\n')),Object(s.b)("h4",{id:"caching"},"Caching"),Object(s.b)("p",null,"Functions generated for tagged template literals are cached. This behavior is same as it of babel."),Object(s.b)("h3",{id:"class_properties-pass"},"class_properties pass"),Object(s.b)("h4",{id:"handle-this-inside-static-properties"},"Handle ",Object(s.b)("inlineCode",{parentName:"h4"},"this")," inside static properties"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," can now handle"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"class A {\n  static f = 1;\n}\n\nclass B extends A {\n  static c = super.f;\n}\n")),Object(s.b)("h4",{id:"handle-private-field-in-complex-assignment"},"Handle private field in complex assignment"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," can now handle"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"class A {\n  #f = 0;\n  #g = 0;\n\n  constructor() {\n      ([#f, #g = 3] = [1, 2])\n  }\n}\n")),Object(s.b)("h4",{id:"handle-super-access-in-properties"},"Handle super access in properties"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," now can handle"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"class A {\n  f = 1;\n}\n\nclass B extends A {\n  c = super.f;\n}\n")),Object(s.b)("h4",{id:"handle-complex-super-initialization"},"Handle complex super initialization"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," now can handle"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"class A extends Parent {\n  constructor() {\n    class B extends (super(), Parent) {}\n  }\n}\n")),Object(s.b)("h3",{id:"object-rest-spread-pass"},"object rest spread pass"),Object(s.b)("h4",{id:"computed-key-with-side-effect"},"Computed key with side effect"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," can now handle complex object pattern like"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const { a, [key++]: b, ...c } = foo;\n")),Object(s.b)("h4",{id:"destructuring-null"},"Destructuring null"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const {} = null;\n")),Object(s.b)("p",null,"now throws an error, instead of being silent."),Object(s.b)("h3",{id:"async_to_generator-pass"},"async_to_generator pass"),Object(s.b)("h4",{id:"efficient-handling-of-simple-async-functions"},"Efficient handling of simple async functions"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," now emits minimal output for"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"async () => await promise;\n")),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"async () => {\n  await promise;\n};\n")),Object(s.b)("h4",{id:"correct-number-of-parameters"},"Correct number of parameters"),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"swc")," now convert async functions in a way that preserves function.length."))}p.isMDXComponent=!0},333:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return j}));var a=n(0),r=n.n(a);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var b=r.a.createContext({}),p=function(e){var t=r.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},i=function(e){var t=p(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,c=e.parentName,b=o(e,["components","mdxType","originalType","parentName"]),i=p(n),d=a,j=i["".concat(c,".").concat(d)]||i[d]||u[d]||s;return n?r.a.createElement(j,l(l({ref:t},b),{},{components:n})):r.a.createElement(j,l({ref:t},b))}));function j(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,c=new Array(s);c[0]=d;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:a,c[1]=l;for(var b=2;b<s;b++)c[b]=n[b];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);