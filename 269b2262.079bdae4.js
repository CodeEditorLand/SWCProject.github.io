(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{120:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return s})),r.d(t,"metadata",(function(){return o})),r.d(t,"toc",(function(){return i})),r.d(t,"default",(function(){return b}));var a=r(3),n=r(7),c=(r(0),r(340)),s={title:"Changelog: swc v1.2.54",author:"DongYoon Kang",authorURL:"http://github.com/kdy1",authorFBID:0x5af8dbecdbce},o={permalink:"/blog/2021/04/20/swc-1.2.54",source:"@site/blog/2021-04-20-swc-1.2.54.md",description:"Bugfixes",date:"2021-04-20T00:00:00.000Z",tags:[],title:"Changelog: swc v1.2.54",readingTime:2.63,truncated:!1,prevItem:{title:"Changelog: swc v1.2.55",permalink:"/blog/2021/05/07/swc-1.2.55"},nextItem:{title:"Changelog: swc v1.2.53",permalink:"/blog/2021/04/17/swc-1.2.53"}},i=[{value:"Bugfixes",id:"bugfixes",children:[{value:"typescript: async override (#1558)",id:"typescript-async-override-1558",children:[]},{value:"dce bug (#1533)",id:"dce-bug-1533",children:[]},{value:"SIGILL (#1583)",id:"sigill-1583",children:[]},{value:"Logical nullish assigments (#1570)",id:"logical-nullish-assigments-1570",children:[]},{value:"Order of statements regarding imports (#1457)",id:"order-of-statements-regarding-imports-1457",children:[]},{value:"Syntax context of super classes (#1586)",id:"syntax-context-of-super-classes-1586",children:[]},{value:"Statement order of default imports. (#1568)",id:"statement-order-of-default-imports-1568",children:[]},{value:"Mixed import of default (#1525)",id:"mixed-import-of-default-1525",children:[]},{value:"SourceMaps (#1581)",id:"sourcemaps-1581",children:[]},{value:"Parameter property decorators (#1456)",id:"parameter-property-decorators-1456",children:[]},{value:"Fix for <code>arguments</code> (#1585)",id:"fix-for-arguments-1585",children:[]},{value:"Fix for decorators (#1362)",id:"fix-for-decorators-1362",children:[]}]}],p={toc:i};function b(e){var t=e.components,r=Object(n.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},p,r,{components:t,mdxType:"MDXLayout"}),Object(c.b)("h2",{id:"bugfixes"},"Bugfixes"),Object(c.b)("h3",{id:"typescript-async-override-1558"},"typescript: async override (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1558"}),"#1558"),")"),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," now supports ",Object(c.b)("inlineCode",{parentName:"p"},"async override")," in addition to ",Object(c.b)("inlineCode",{parentName:"p"},"override async"),"."),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"class Base {\n    method1() {}\n    method2() {}\n}\n\nclass Test extends Base {\n    public override async method1() {\n        return Promise.resolve(1);\n    }\n\n    public async override method2() {\n        return Promise.resolve(1);\n    }\n}\n")),Object(c.b)("h3",{id:"dce-bug-1533"},"dce bug (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1533"}),"#1533"),")"),Object(c.b)("p",null,"Previously ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," had a bug that causes a usage of a variable in the discriminant of a switch statement not treated as a usage.\nIt's now fixed and code like below works even if the optimizer is enabled."),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"var this_will_disappear; // <-- this variable declaration disappears\nfunction a(x) {\n  switch (this_will_disappear) {\n    case x:\n      return;\n  }\n}\nfunction b() {\n  c();\n}\nfunction c() {\n  b();\n  d();\n}\nfunction d() {\n  a();\n}\n")),Object(c.b)("h3",{id:"sigill-1583"},"SIGILL (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1583"}),"#1583"),")"),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," used ",Object(c.b)("inlineCode",{parentName:"p"},"aes")," feature of cpus as an optimization, but it caused ",Object(c.b)("inlineCode",{parentName:"p"},"SIGILL")," on a user's pc.\nSo I disabled ",Object(c.b)("inlineCode",{parentName:"p"},"aes")," feature."),Object(c.b)("h3",{id:"logical-nullish-assigments-1570"},"Logical nullish assigments (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1570"}),"#1570"),")"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"const a: { [a: string]: string } = {};\na.b ??= \"1\";\nconsole.log(a); // expect: { b: '1' }\n")),Object(c.b)("p",null,"The code above was miscompieled by ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc"),", but it's now fixed."),Object(c.b)("h3",{id:"order-of-statements-regarding-imports-1457"},"Order of statements regarding imports (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1457"}),"#1457"),")"),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," now preserve order of statements even if there are some imports.\nThis is to fix code like"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),'import {\n  setGlobalOptions,\n  plugin,\n  buildSchema,\n  addModelToTypegoose,\n  deleteModel,\n} from "@typegoose/typegoose";\nimport * as typegoose from "@typegoose/typegoose";\n// typegoose.mongoose.set(\'debug\', true);\nsetGlobalOptions({\n  options: {\n    allowMixed: typegoose.Severity.ALLOW,\n  },\n  schemaOptions: {\n    timestamps: {\n      createdAt: "created_at",\n      updatedAt: "updated_at",\n    },\n  },\n});\nimport { schemas } from "./schemas";\n')),Object(c.b)("h3",{id:"syntax-context-of-super-classes-1586"},"Syntax context of super classes (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/pull/1586"}),"#1586"),")"),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," had a bug which makes"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"class Foo {}\nclass Test extends Foo {\n  foo() {\n    console.log(Foo);\n  }\n}\nFoo = 3;\nnew Foo().foo();\n")),Object(c.b)("p",null,"to emit ",Object(c.b)("inlineCode",{parentName:"p"},"Foo")," instead of 3."),Object(c.b)("p",null,"It's fixed by ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/devongovett"}),"@devongovett"),"."),Object(c.b)("h3",{id:"statement-order-of-default-imports-1568"},"Statement order of default imports. (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1568"}),"#1568"),")"),Object(c.b)("p",null,"To workaroudn ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/webpack/webpack/issues/7767"}),"a bug of webpack"),", I modified order of statements generated from ",Object(c.b)("inlineCode",{parentName:"p"},"export default function"),"s."),Object(c.b)("p",null,"Thankfully, ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/josteph"}),"@josteph")," explained the problem and suggested the way to fix."),Object(c.b)("h3",{id:"mixed-import-of-default-1525"},"Mixed import of default (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1525"}),"#1525"),")"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),'import { Component, default as React } from "react";\n\nclass X extends Component {}\n\nReact.render(document.getElementById("root"), <X></X>);\n')),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," previously miscompied this, because it wasn't careful enough about ",Object(c.b)("inlineCode",{parentName:"p"},"default as Foo"),"-style imports.\nIt's fixed and ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," now emits"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'var _react = _interopRequireWildcard(require("react"));\n\nclass X extends _react.Component {}\n_react.default.render(\n  document.getElementById("root"),\n  /*#__PURE__*/ _react.default.createElement(X, null)\n);\n')),Object(c.b)("p",null,"which is correct."),Object(c.b)("h3",{id:"sourcemaps-1581"},"SourceMaps (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1581"}),"#1581"),")"),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," had a bug related to inline source maps and as a result it generated empty sourcemap.\nIt's fixed."),Object(c.b)("h3",{id:"parameter-property-decorators-1456"},"Parameter property decorators (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1456"}),"#1456"),")"),Object(c.b)("p",null,Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," had a bug in logic for determining if it should work.\nWhile checking existance of decortor, ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," didn't check decorators of typescript parameter properties."),Object(c.b)("p",null,"As a result, decorator didn't work if ",Object(c.b)("strong",{parentName:"p"},"all")," constructor parameters are parameter properties.\nIt's now fixed and decorators are properly applied."),Object(c.b)("h3",{id:"fix-for-arguments-1585"},"Fix for ",Object(c.b)("inlineCode",{parentName:"h3"},"arguments")," (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/pull/1585"}),"#1585"),")"),Object(c.b)("p",null,"There was a bug of ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://swc.rs"}),"swc")," which may break some codes using arguments in arrow functions."),Object(c.b)("p",null,"It could break codes like"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"function test() {\n  return () => arguments[0];\n}\n")),Object(c.b)("p",null,"Fixed by ",Object(c.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/devongovett"}),"@devongovett"),"."),Object(c.b)("h3",{id:"fix-for-decorators-1362"},"Fix for decorators (",Object(c.b)("a",Object(a.a)({parentName:"h3"},{href:"https://github.com/swc-project/swc/issues/1362"}),"#1362"),")"),Object(c.b)("p",null,"Fixed as a part of decorator fixes."))}b.isMDXComponent=!0},340:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return m}));var a=r(0),n=r.n(a);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},c=Object.keys(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=n.a.createContext({}),b=function(e){var t=n.a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},l=function(e){var t=b(e.components);return n.a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},d=n.a.forwardRef((function(e,t){var r=e.components,a=e.mdxType,c=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),l=b(r),d=a,m=l["".concat(s,".").concat(d)]||l[d]||u[d]||c;return r?n.a.createElement(m,o(o({ref:t},p),{},{components:r})):n.a.createElement(m,o({ref:t},p))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=r.length,s=new Array(c);s[0]=d;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var p=2;p<c;p++)s[p]=r[p];return n.a.createElement.apply(null,s)}return n.a.createElement.apply(null,r)}d.displayName="MDXCreateElement"}}]);